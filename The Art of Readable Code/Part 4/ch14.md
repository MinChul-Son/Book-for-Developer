# 14. 테스트와 가독성
`테스트`란 코드 조각이 수행하는 행위를 검사하는데 국한된 코드를 의미한다.

<br>

## 읽거나 유지보수하기 쉽게 테스트를 만들어라
**테스트 코드는 실제 코드가 어떻게 동작하며 어떻게 사용되어야 하는지를 보여주는 비공식적인 문서**이다!!

따라서, 테스트 코드가 읽기 쉬우면 사용자는 실제 코드의 동작에 대해 이해하기 쉬워진다.

<br>

### 덜 중요한 세부 사항은 사용자가 볼 필요 없게 숨겨서 더 중요한 내용이 눈에 잘 띄게 해야한다.
- 값을 넣고, 객체를 생성하는 등의 행위는 사전 메소드(ex: `setUp`)과 같은 헬퍼 메소드를 사용하여 세팅하라는 의미

```
Person person = new Person();

// 검증하고자하는 것은 doSomething이다.
assertThat(person.doSomething()).isTrue();
```

위와 같이 검증하고자하는 것은 `doSomething`의 동작이다.

그 외의 덜 중요한 세부 사항은 다른 헬퍼 메소드를 사용하여 더 깔끔하게 처리하라는 의미이다.

<br>

### 최소한의 테스트 구문 만들기
테스트를 해야하는 대상이 무엇인지 어디까지인지를 명확히 판단하고 최소한의 범위의 테스트 코드로 만들어라!

<br>

### 좋은 테스트 입력값의 선택
어떤 입력값을 넣어 테스트를 할 것인지도 중요한 요소이다.

**가능하면 가장 간단한 입력으로 코드를 완전히 검사할 수 있어야한다.**

필요한 범위 내에서 가장 명확하고 간단한 테스트 값을 선택하라!

<br>

### 하나보단 여러개
코드를 구석구석 철저하게 수행하려고 하나의 완벽한 입력을 사용하는 것보다는 작은 테스트를 여러개 사용하는 것이 더 효과적이다.

각 테스트는 각자의 흐름을 가지고 있기 때문이다.

<br>

### 테스트 함수에 이름 붙이기
좋은 이름을 붙이는 것은 테스트 코드도 예외는 아니다.

`Test1` 보다는 어떤 기능을 테스트하려는지를 나타내는 것이 좋다.

또, `Junit`의 `@DisplayName`과 같은 애노테이션을 사용해 테스트 시나리오를 자세히 작성할 수도 있다.

추가로, 테스트 코드는 실제 코드베이스에서 호출되는 함수가 아니기 때문에, `함수명을 너무 길지 않게 해야 한다.`라는 원리가 적용되지 않는다.

<br>

### 테스트에 친숙한 개발
테스트하기 좋은 코드는 **잘 정의된 인터페이스**를 가지고, **지나치게 많은 상태나 설정을 요구하지 않으며**, **감추어진 데이터를 포함하지 않는다**.

코드를 역할과 책임에 맞게 잘 분리하는 것만으로도 테스트 코드를 작성하기 좋게 만들 수 있다.

초기화되어야 하는 전역 변수, 라이브러리, 읽혀야 하는 구성 파일과 같은 `외부` 컴포넌트를 많이 포함하는 것도 테스트 코드 작성을 힘들게 한다.

<br>

| 특징                                 | 테스트 장점                                                        | 설계 장점                                                                         |
|------------------------------------|---------------------------------------------------------------|-------------------------------------------------------------------------------|
| 클래스들이 내부 상태를 거의 가지고 있지 않다.         | 메소드를 테스트하기 전에 설정할 일이 거의 없고 감추어 있는 상태가 별로 없기 때문에 테스트 작성이 수월하다. | 소수의 내부 상태를 가지는 클래스는 이해하기 더 간단하고 쉽다.                                           |
| 클래스/함수가 한 번에 하나의 일만 수행한다.          | 더 적은 테스트 코드가 요구된다.                                            | 더 작고 간단한 컴포넌트는 더 잘 모듈화되어 있고 시스템이 서로 더 멀리 떨어져 있다.                              |
| 클래스가 다른 클래스에 의존하지 않고 서로 상당히 떨어져있다. | 각 클래스가 독립적으로 테스트된다.                                           | 시스템이 병렬적으로 개발될 수 있다. 클래스가 쉽게 수정될 수 있고, 혹은 시스템의 나머지 부분에 영향을 주지 않으면서 제거될 수도 있다. |
| 함수들이 간단하고 잘 정의된 인터페이스를 가지고 있다.     | 테스트 대상이 잘 정의되어 있다. 간단한 인터페이스는 테스트를 위해서 더 적은 일을 요구한다.          | 프로그래머가 인터페이스를 쉽게 배울 수 있어 해당 인터페이스는 재사용될 가능성이 높다.                              |

<br>

### 지나친 테스트
- 테스트를 위해 실제 코드의 가독성을 희생시키는 일
- 100% 테스트 커버리지에 집착하는 일
  - 실제로 100% 테스트하는 일은 일어나지 않는다. 테스트되지 않은 버그가 있을 수도 있고, 테스트되지 않은 기능이 있을 수도 있고 요구사항이 달라졌을 수도 있기 때문에
- 테스트 코드로 인해 실제 개발이 차질을 빚게 되는 일